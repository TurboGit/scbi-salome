
inherit-plugin s-saturne

function s-saturne-dbg-config-options()
{
    local PREFIX=$1
    local TARGET=$2

    echo FC=gfortran
    echo CC=mpicc
    echo CCX=mpicxx
    echo --prefix=$PREFIX
    echo --enable-debug
    echo --disable-frontend
    echo --with-salome=$SALOME_ROOT_DIR
    echo --with-mpi=$MPI_ROOT_DIR
}

function s-saturne-dbg-env()
{
    local PREFIX=$1
    local TARGET=$2
}

function s-saturne-dbg-post-build()
{
    local PREFIX=$1
    local TARGET=$2

    make doc
}

function s-saturne-dbg-post-install()
{
    local PREFIX=$1
    local TARGET=$2

    make install-doc

    cd $PREFIX/etc

    local APPEND=`echo "compute_versions = :$(basename $PREFIX)"`
    sed "s|# compute_versions =|${APPEND}|" \
        code_saturne.cfg.template > code_saturne.cfg

    sed "/distant installation paths/a\slurm_cronos=/sofware/rd/saturne/code_saturne/7.0/arch
slurm_gaia=/projets/saturne/Code_Saturne/7.0/arch" \
        code_saturne.cfg > code_saturne.cfg.template
    mv code_saturne.cfg.template code_saturne.cfg
}
