
# Note that OpenGL support is needed here as required by PyQt
# later. We note them here as the real support depends on the
# hardware.
#
# apt install libgles2-mesa-dev
# apt install os@-glu1-mesa-dev
# apt install mesa-common-dev

with-variant native \
             os@-qt5-default os@-qtbase5-dev \
             os@-qt5opengl5-dev os@-qt5printsupport5 \
       --env 'set-var QT5_ROOT_DIR /usr'

function s-qt-vcs()
{
    echo edf
    echo none
    echo git
    echo https://github.com/qt/qt5.git
}

function s-qt-tar()
{
    local VERSION=$1

    echo default
    echo none
    echo wget
    echo https://minio.retd.edf.fr/salome/YAMM/Public/SALOME/sources/prerequis
    echo qt-everywhere-opensource-src-$VERSION.tar.gz
}

function s-qt-build-depends()
{
    echo os@-autoconf
}

function s-qt-env()
{
    local PREFIX=$1
    local TARGET=$2

    set-var    QT5_ROOT_DIR      $PREFIX

    add-to-var CMAKE_PREFIX_PATH           $PREFIX/lib/cmake
    add-to-var PATH                        $PREFIX/bin
    add-to-var LD_LIBRARY_PATH             $PREFIX/lib
    add-to-var C_INCLUDE_PATH              $PREFIX/include
    add-to-var CPLUS_INCLUDE_PATH          $PREFIX/include
    add-to-var QT_PLUGIN_PATH              $PREFIX/plugins
    add-to-var QT_QPA_PLATFORM_PLUGIN_PATH $PREFIX/plugins/platforms
}

function s-qt-config-options()
{
    local PREFIX=$1
    local TARGET=$2
    local VARIANT=$3

    echo --prefix=$PREFIX
    echo -opensource
    echo -confirm-license
    echo -nomake examples
    echo -nomake tests
}

function s-qt-config()
{
    local PREFIX=$1
    local TARGET=$2
    local VARIANT=$3

    local OPTIONS=( $(get-config-options $PREFIX $TARGET $VARIANT) )

    ../src/configure ${OPTIONS[*]}
}

function s-qt-build()
{
    local PREFIX=$1
    local TARGET=$2

    make -j$SCBI_JOBS
}

function s-qt-install()
{
    local PREFIX=$1
    local TARGET=$2

    make install
}

function s-qt-prefix()
{
    echo NONE
}
